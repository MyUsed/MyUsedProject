<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="member">

	<insert id="insertMem"  parameterClass="member.MemberDTO">
		insert into memberlist values(sq_memberlist.NEXTVAL, #id#, #name#, #password#, #birthdate#, #gender#, #grade#, #point#, #onoff#, #naverid#, #chatonoff# )
	</insert>

	<!-- 가입되어 있는 아이디인지 체크(네이버) -->
	<select id="checkNaverId" resultClass="int" parameterClass="String">
		select count(*) from memberlist where naverid=#naverid#
	</select>
	
	<select id="checkId" resultClass="int" parameterClass="String">
		select count(*) from memberlist where id=#id#
	</select>

	<!-- 가입된 아이디인지 체크(일반) -->
	<select id="loginCheck" resultClass="int" parameterClass="java.util.Map">
		select count(*) from memberlist where id=#id# and password=#password#
	</select>
	
	<select id="selectName" resultClass="String" parameterClass="String">
		select name from memberlist where id=#id#
	</select>
	
	<select id="selectDTO" resultClass="member.MemberDTO" parameterClass="String">
		select * from memberlist where id=#id#
	</select>
	
	<select id="selectDTOforNum" resultClass="member.MemberDTO" parameterClass="int">
		select * from memberlist where num=#num#
	</select>
	
	<select id="searchMember" resultClass="member.MemberDTO" parameterClass="String">
		select * from memberlist where name like '%'||#name#||'%' order by num desc
	</select>

	<select id="joinedNaverId" resultClass="int" parameterClass="String">
		select naverid from (select * from memberlist where id=#id#)
	</select>
	
	<select id="findNum" resultClass="int" parameterClass="member.MemberDTO">
		select num from memberlist where id=#id# and name=#name# and password=#password#
	</select>

	<update id="Log_on" parameterClass="String">
		update memberlist set onoff=1 where id=#id#
	</update>

	<update id="Log_off" parameterClass="String">
		update memberlist set onoff=0 where id=#id#
	</update>

	<select id="findOnOff" resultClass="int" parameterClass="java.util.Map" >
		select onoff from friendlist_$num$, memberlist where friendlist_$num$.mem_num = memberlist.num
	</select>
	

</sqlMap>